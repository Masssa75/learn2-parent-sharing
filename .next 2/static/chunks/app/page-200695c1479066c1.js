(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4474:(e,t,r)=>{Promise.resolve().then(r.bind(r,7424)),Promise.resolve().then(r.bind(r,5725))},7424:(e,t,r)=>{"use strict";r.d(t,{default:()=>l});var s=r(5155),a=r(2115);class l extends a.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t)}render(){return this.state.hasError?this.props.fallback||(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center p-8",children:(0,s.jsxs)("div",{className:"card max-w-md w-full text-center",children:[(0,s.jsx)("h2",{className:"text-title font-bold mb-4",children:"Oops! Something went wrong"}),(0,s.jsx)("p",{className:"text-text-secondary mb-6",children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Refresh Page"}),!1]})}):this.props.children}constructor(e){super(e),this.state={hasError:!1}}}},5725:(e,t,r)=>{"use strict";r.d(t,{default:()=>m});var s=r(5155),a=r(2115),l=r(4839),i=r.n(l),n=r(6046),o=r(6536);function d(e){let{url:t,title:r}=e,a=(0,o.Zb)(t);return a?(0,s.jsx)("div",{className:"relative w-full aspect-video bg-dark-surface rounded-card overflow-hidden",children:(0,s.jsx)("iframe",{src:(0,o.CZ)(a),title:r||"YouTube video player",frameBorder:"0",referrerPolicy:"strict-origin-when-cross-origin",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,className:"absolute inset-0 w-full h-full"})}):null}function c(e){let{points:t,xp:r,level:l,actionsRemaining:i}=e,[n,o]=(0,a.useState)([]),[d,c]=(0,a.useState)(t),[u,m]=(0,a.useState)(!1),h=(0,a.useRef)(0),x=(0,a.useRef)(t);(0,a.useEffect)(()=>{if(t!==x.current){let e=t-x.current;x.current=t;let r="anim-".concat(h.current++),s={id:r,points:e,x:40*Math.random()-20,y:-20,timestamp:Date.now()};o(e=>[...e,s]);let a=e/20,l=0,i=setInterval(()=>{++l>=20?(c(t),clearInterval(i)):c(e=>Math.round(e+a))},30);e>0&&h.current%10==0&&p(),setTimeout(()=>{o(e=>e.filter(e=>e.id!==r))},2e3)}},[t]);let p=()=>{m(!0),setTimeout(()=>m(!1),3e3)},{progress:f,remaining:g}=(()=>{let e=(l-1)*1e3,t=1e3*l;return{progress:(r-e)/(t-e)*100,remaining:t-r}})();return(0,s.jsxs)("div",{className:"relative",children:[u&&(0,s.jsx)("div",{className:"fixed inset-0 pointer-events-none z-50",children:[...Array(20)].map((e,t)=>(0,s.jsx)("div",{className:"absolute animate-fall",style:{left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(2*Math.random(),"s"),animationDuration:"".concat(3+2*Math.random(),"s")},children:(0,s.jsx)("span",{className:"text-2xl",children:"\uD83E\uDE99"})},t))}),(0,s.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-dark-background rounded-card border border-dark-border",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-primary rounded-full flex items-center justify-center text-black font-bold text-lg",children:l}),(0,s.jsx)("span",{className:"text-xs text-text-muted mt-1",children:"Level"})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,s.jsxs)("span",{className:"text-2xl font-bold text-primary relative",children:[d.toLocaleString(),n.map(e=>(0,s.jsxs)("span",{className:"absolute text-sm font-bold animate-float-up",style:{left:"".concat(e.x,"px"),top:"".concat(e.y,"px"),color:e.points>0?"#F5D547":"#ef4444"},children:[e.points>0?"+":"",e.points]},e.id))]}),(0,s.jsx)("span",{className:"text-sm text-text-muted",children:"points this week"})]}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-xs text-text-muted mb-1",children:[(0,s.jsxs)("span",{children:[r.toLocaleString()," XP"]}),(0,s.jsxs)("span",{children:[g.toLocaleString()," to level ",l+1]})]}),(0,s.jsx)("div",{className:"h-2 bg-dark-border rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-primary transition-all duration-500",style:{width:"".concat(f,"%")}})})]})]}),void 0!==i&&(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-text-secondary",children:i}),(0,s.jsx)("div",{className:"text-xs text-text-muted",children:"actions left"})]})]})]})}let u=["ALL","APPS","TOYS","BOOKS","ACTIVITIES","TIPS"];function m(e){let{showAuthPrompt:t=!0,protectedRoute:r=!1}=e,[l,o]=(0,a.useState)([]),[m,h]=(0,a.useState)("ALL"),[x,p]=(0,a.useState)(null),[f,g]=(0,a.useState)(!1),[b,v]=(0,a.useState)(!0),[y,w]=(0,a.useState)(!1),[j,k]=(0,a.useState)(null),[N,C]=(0,a.useState)({title:"",description:"",linkUrl:"",imageUrl:""}),[S,E]=(0,a.useState)(!1),[P,T]=(0,a.useState)(new Set),[U,L]=(0,a.useState)(null),[A,_]=(0,a.useState)({}),I=(0,a.useRef)(0),F=(0,n.useRouter)();(0,a.useEffect)(()=>{let e=!0,t=()=>{e&&M().then(()=>{R()})};return M().then(()=>{e&&R()}),window.addEventListener("focus",t),()=>{e=!1,window.removeEventListener("focus",t)}},[]),(0,a.useEffect)(()=>{!b&&(null==x?void 0:x.id)&&(console.log("Auth status changed, refetching posts with user:",x.id),R())},[null==x?void 0:x.id,b]),(0,a.useEffect)(()=>{let e=e=>{e.target.closest(".post-menu")||L(null)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),(0,a.useEffect)(()=>{j&&setTimeout(()=>{let e=document.querySelector('textarea[placeholder="Description"]');e&&(e.style.height="auto",e.style.height=e.scrollHeight+"px")},100)},[j]);let M=async()=>{try{let e=await fetch("/api/auth/check",{credentials:"include"});if(!e.ok)throw Error("Auth check failed: ".concat(e.status));let t=await e.json();g(!0===t.authenticated),t.authenticated&&t.user?p({id:t.user.id,telegramId:t.user.telegram_id,username:t.user.telegram_username,firstName:t.user.first_name,lastName:t.user.last_name,photoUrl:t.user.photo_url,displayName:t.user.first_name||t.user.telegram_username||"User",isAdmin:"admin"===t.user.role,points:t.user.points||0,totalXp:t.user.total_xp||0,level:t.user.level||1,actionsRemaining:t.user.actions_remaining}):p(null),r&&!t.authenticated&&F.push("/")}catch(e){console.error("Auth check failed:",e),g(!1),p(null),r&&F.push("/")}},R=async()=>{try{console.log("Fetching posts, authenticated:",f,"user:",null==x?void 0:x.id);let t=await fetch("/api/posts",{credentials:"include"});if(!t.ok)throw Error("Failed to fetch posts: ".concat(t.status));let r=await t.json();if(Array.isArray(r))o(r);else if(r&&Array.isArray(r.posts)){var e;console.log("Received ".concat(r.posts.length," posts, first post liked status:"),null===(e=r.posts[0])||void 0===e?void 0:e.liked),o(r.posts)}else console.error("Invalid posts data received:",r),o([])}catch(e){console.error("Error fetching posts:",e),o([])}finally{v(!1)}},O=async()=>{try{let e=await fetch("/api/auth/logout",{method:"POST",credentials:"include"});if(!e.ok)throw Error("Logout failed: ".concat(e.status));p(null),g(!1),w(!1),F.push("/"),setTimeout(()=>window.location.reload(),100)}catch(e){console.error("Sign out failed:",e),p(null),g(!1),w(!1),F.push("/")}},B=async e=>{if(!f){F.push("/login");return}let t=l.find(t=>t.id===e);if(null==t||!t.liked)try{let t=await fetch("/api/actions",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({actionType:"add_to_profile",targetType:"post",targetId:e})});if(!t.ok){let r=await t.json();if(429===t.status)alert("Rate limit exceeded. Please wait before taking more actions.");else if(409===t.status)o(l.map(t=>t.id===e?{...t,liked:!0}:t));else throw Error(r.message||"Failed to like post");return}let r=await t.json(),s=I.current++;_(t=>({...t,[e]:{points:5,key:s}})),setTimeout(()=>{_(t=>{var r;let a={...t};return(null===(r=a[e])||void 0===r?void 0:r.key)===s&&delete a[e],a})},2e3),r.user&&x&&p({...x,points:r.user.points,totalXp:r.user.total_xp,level:r.user.level,actionsRemaining:r.remaining_actions}),o(l.map(t=>t.id===e?{...t,liked:!0,likes:t.likes+1}:t))}catch(e){console.error("Error liking post:",e)}},D=async e=>{if(!f){F.push("/login");return}let t=l.find(t=>t.id===e);if(null==t||!t.saved)try{let t=await fetch("/api/actions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({actionType:"add_to_watchlist",targetType:"post",targetId:e})});if(!t.ok){let r=await t.json();if(429===t.status)alert("Rate limit exceeded. Please wait before taking more actions.");else if(409===t.status)o(l.map(t=>t.id===e?{...t,saved:!0}:t));else throw Error(r.message||"Failed to save post");return}let r=await t.json(),s=I.current++;_(t=>({...t,["".concat(e,"-save")]:{points:3,key:s}})),setTimeout(()=>{_(t=>{var r;let a={...t};return(null===(r=a["".concat(e,"-save")])||void 0===r?void 0:r.key)===s&&delete a["".concat(e,"-save")],a})},2e3),r.user&&x&&p({...x,points:r.user.points,totalXp:r.user.total_xp,level:r.user.level,actionsRemaining:r.remaining_actions}),o(l.map(t=>t.id===e?{...t,saved:!0}:t))}catch(e){console.error("Error saving post:",e)}},W=async e=>{if(!f){F.push("/login");return}if(confirm("Are you sure you want to report this post? This will cost you 2 points."))try{let t=await fetch("/api/actions",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({actionType:"flag",targetType:"post",targetId:e})});if(!t.ok){let e=await t.json();if(429===t.status)alert("Rate limit exceeded. Please wait before taking more actions.");else throw Error(e.message||"Failed to report post");return}let r=await t.json();r.user&&x&&p({...x,points:r.user.points,totalXp:r.user.total_xp,level:r.user.level,actionsRemaining:r.remaining_actions}),alert("Post reported. Thank you for helping keep the community safe.")}catch(e){console.error("Error reporting post:",e),alert("Failed to report post. Please try again.")}},z=async e=>{if(confirm("Are you sure you want to delete this post?"))try{if(!(await fetch("/api/posts/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete post");o(l.filter(t=>t.id!==e))}catch(e){console.error("Error deleting post:",e),alert("Failed to delete post. Please try again.")}},V=e=>{k(e.id),C({title:e.title,description:e.description||"",linkUrl:e.linkUrl||"",imageUrl:e.imageUrl||""})},H=()=>{k(null),C({title:"",description:"",linkUrl:"",imageUrl:""}),E(!1)},G=async e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(r.type)){alert("Please select a valid image file (JPEG, PNG, GIF, or WebP)");return}if(r.size>5242880){alert("File size must be less than 5MB");return}E(!0);try{let e=new FormData;e.append("file",r);let t=await fetch("/api/upload",{method:"POST",body:e});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to upload image")}let s=await t.json();C({...N,imageUrl:s.url})}catch(e){console.error("Upload error:",e),alert("Failed to upload image. Please try again.")}finally{E(!1)}}},X=()=>{C({...N,imageUrl:""})},J=async e=>{try{let t=await fetch("/api/posts/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to update post")}o(l.map(t=>t.id===e?{...t,title:N.title,description:N.description,linkUrl:N.linkUrl,imageUrl:N.imageUrl}:t)),k(null),C({title:"",description:"",linkUrl:"",imageUrl:""}),E(!1)}catch(e){console.error("Error updating post:",e),alert(e instanceof Error?e.message:"Failed to update post. Please try again.")}},Z=e=>{try{return new URL(e).hostname}catch(t){return e}},Y=e=>{let t=new Set(P);t.has(e)?t.delete(e):t.add(e),T(t)},K="ALL"===m?l||[]:(l||[]).filter(e=>{var t;let r=null===(t=e.category)||void 0===t?void 0:t.name;return r&&r===({APPS:"Apps & Software",TOYS:"Toys & Games",BOOKS:"Books",ACTIVITIES:"Activities",TIPS:"Parenting Tips"})[m]});return(0,s.jsxs)("div",{className:"min-h-screen bg-dark-bg",children:[(0,s.jsx)("div",{className:"sticky top-0 bg-dark-bg z-10",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto px-5 pt-6 pb-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h1",{className:"text-display text-text-primary",children:"Discover"}),f?(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[x&&(0,s.jsx)(c,{points:x.points||0,xp:x.totalXp||0,level:x.level||1,actionsRemaining:x.actionsRemaining}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>w(!y),className:"w-12 h-12 bg-brand-yellow rounded-avatar flex items-center justify-center overflow-hidden relative group",title:(null==x?void 0:x.displayName)||"Profile",children:[(null==x?void 0:x.photoUrl)&&(0,s.jsx)("img",{src:x.photoUrl,alt:x.displayName,className:"w-full h-full object-cover absolute inset-0",onError:e=>{e.currentTarget.style.display="none"},onLoad:e=>{let t=e.currentTarget;(0===t.naturalWidth||0===t.naturalHeight)&&(t.style.display="none")}}),(0,s.jsx)("span",{className:"".concat((null==x?void 0:x.firstName)?"text-black font-semibold text-2xl":"text-xl"," flex items-center justify-center w-full h-full"),children:(null==x?void 0:x.firstName)?x.firstName.charAt(0).toUpperCase():x?"U":"\uD83D\uDC64"})]}),y&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-dark-surface rounded-card shadow-lg py-2 border border-dark-border",children:[(0,s.jsx)(i(),{href:"/profile",className:"block w-full text-left px-4 py-2 text-text-primary hover:bg-white/5",children:"View Profile"}),(null==x?void 0:x.isAdmin)&&(0,s.jsx)(i(),{href:"/admin",className:"block w-full text-left px-4 py-2 text-text-primary hover:bg-white/5",children:"Admin Dashboard"}),(0,s.jsx)("button",{onClick:O,className:"w-full text-left px-4 py-2 text-text-primary hover:bg-white/5",children:"Sign Out"})]})]})]}):(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>F.push("/login"),className:"bg-brand-yellow/20 border border-brand-yellow text-brand-yellow rounded-button px-4 py-2 text-sm font-semibold uppercase tracking-wider hover:bg-brand-yellow/30 transition-all cursor-pointer",children:"CLAIM +100"}),(0,s.jsx)(i(),{href:"/login",className:"px-6 py-3 bg-brand-yellow text-black rounded-button font-semibold hover:scale-105 btn-transition",children:"SIGN IN"})]})]}),(0,s.jsx)("p",{className:"text-text-secondary text-body-lg mb-6",children:"What's working for parents today"}),(0,s.jsx)("div",{className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",children:u.map(e=>(0,s.jsx)("button",{onClick:()=>h(e),className:"px-6 py-3 rounded-button whitespace-nowrap transition-all font-semibold text-body ".concat(m===e?"bg-brand-yellow text-black":"bg-transparent text-text-primary border border-dark-border hover:bg-white/5"),children:e},e))})]})}),f&&x&&(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-5",children:(0,s.jsx)(c,{points:x.points||0,xp:x.totalXp||0,level:x.level||1,actionsRemaining:x.actionsRemaining||0})}),(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-5 pb-20 custom-scrollbar",children:b?(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand-yellow"})}):0===K.length?(0,s.jsxs)("div",{className:"text-center py-16",children:[(0,s.jsx)("p",{className:"text-text-secondary text-body-lg mb-4",children:"No posts yet"}),(0,s.jsx)("p",{className:"text-text-muted text-body",children:f?"Be the first to share something amazing!":"Sign in to start sharing your discoveries"})]}):K.map(e=>{var t;return(0,s.jsxs)("div",{className:"mb-8",children:[j===e.id?(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("input",{type:"text",value:N.title,onChange:e=>C({...N,title:e.target.value}),className:"w-full px-4 py-3 bg-dark-surface border border-dark-border rounded-input text-text-primary mb-3 focus:outline-none focus:border-brand-yellow",placeholder:"Title"}),(0,s.jsx)("textarea",{value:N.description,onChange:e=>{C({...N,description:e.target.value}),e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},className:"w-full px-4 py-3 bg-dark-surface border border-dark-border rounded-input text-text-primary mb-3 focus:outline-none focus:border-brand-yellow resize-y overflow-hidden",placeholder:"Description",rows:3,style:{minHeight:"100px"}}),(0,s.jsx)("input",{type:"text",value:N.linkUrl,onChange:e=>C({...N,linkUrl:e.target.value}),className:"w-full px-4 py-3 bg-dark-surface border border-dark-border rounded-input text-text-primary mb-3 focus:outline-none focus:border-brand-yellow",placeholder:"Link URL (optional)"}),(0,s.jsx)("div",{className:"mb-3",children:N.imageUrl?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:N.imageUrl,alt:"Post image",className:"w-full h-48 object-cover rounded-card mb-2"}),(0,s.jsx)("button",{onClick:X,className:"absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-1 w-6 h-6 flex items-center justify-center text-xs",children:"\xd7"})]}):(0,s.jsxs)("div",{className:"border-2 border-dashed border-dark-border rounded-card p-4 text-center",children:[(0,s.jsx)("input",{type:"file",id:"imageUpload",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:G,className:"hidden",disabled:S}),(0,s.jsx)("label",{htmlFor:"imageUpload",className:"cursor-pointer ".concat(S?"opacity-50":""),children:S?(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-brand-yellow"}),(0,s.jsx)("span",{className:"text-text-muted",children:"Uploading..."})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)("svg",{className:"w-8 h-8 text-text-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,s.jsx)("span",{className:"text-text-muted text-sm",children:"Click to add image"}),(0,s.jsx)("span",{className:"text-text-muted text-xs",children:"JPEG, PNG, GIF, WebP up to 5MB"})]})})]})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-4xl text-text-primary mb-4 font-semibold",children:e.title}),e.description&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("p",{className:"text-body text-gray-300 leading-relaxed ".concat(P.has(e.id)?"":"line-clamp-2"),children:e.description}),e.description.length>150&&(0,s.jsx)("button",{onClick:()=>Y(e.id),className:"text-text-muted hover:text-text-secondary text-sm mt-1",children:P.has(e.id)?"Show less":"Read more"})]})]}),e.imageUrl&&(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("img",{src:e.imageUrl,alt:e.title,className:"w-full h-auto rounded-card"})}),e.youtubeVideoId&&(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(d,{url:"https://www.youtube.com/watch?v=".concat(e.youtubeVideoId),title:e.title})}),e.linkUrl&&!e.youtubeVideoId&&(0,s.jsx)("div",{className:"bg-dark-surface rounded-card p-4 mb-6",children:(0,s.jsxs)("a",{href:e.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 text-brand-yellow hover:underline",children:[(0,s.jsx)("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),(0,s.jsx)("span",{className:"truncate",children:Z(e.linkUrl)})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm text-text-muted mb-4",children:[(0,s.jsx)("span",{className:"text-text-secondary",children:(null===(t=e.user)||void 0===t?void 0:t.name)||"Anonymous"}),(0,s.jsxs)("div",{className:"flex items-center gap-5",children:[(0,s.jsxs)("button",{onClick:()=>B(e.id),className:"relative flex items-center gap-1.5 transition-colors ".concat(e.liked?"text-brand-yellow":"text-text-muted hover:text-text-secondary"),disabled:e.liked,children:[(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:e.liked?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),(0,s.jsx)("span",{children:e.likes>0?e.likes:"Like"}),A[e.id]&&(0,s.jsxs)("span",{className:"absolute -top-2 left-1/2 -translate-x-1/2 text-sm font-bold text-brand-yellow animate-float-up pointer-events-none",style:{animationDuration:"2s",animationFillMode:"forwards"},children:["+",A[e.id].points]})]}),(0,s.jsxs)("button",{onClick:()=>{},className:"flex items-center gap-1.5 text-text-muted hover:text-text-secondary transition-colors",children:[(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),(0,s.jsx)("span",{children:e.comments>0?e.comments:"Comment"})]}),(0,s.jsxs)("button",{onClick:()=>D(e.id),className:"relative flex items-center gap-1.5 transition-colors ".concat(e.saved?"text-brand-yellow":"text-text-muted hover:text-text-secondary"),disabled:e.saved,children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),(0,s.jsx)("polyline",{points:"16 6 12 2 8 6"}),(0,s.jsx)("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]}),(0,s.jsx)("span",{children:"Share"}),A["".concat(e.id,"-save")]&&(0,s.jsxs)("span",{className:"absolute -top-2 left-1/2 -translate-x-1/2 text-sm font-bold text-brand-yellow animate-float-up pointer-events-none",style:{animationDuration:"2s",animationFillMode:"forwards"},children:["+",A["".concat(e.id,"-save")].points]})]}),(0,s.jsxs)("div",{className:"relative post-menu",children:[(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),L(U===e.id?null:e.id)},className:"p-1 -m-1 hover:bg-white/5 rounded-full transition-colors",children:(0,s.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-text-muted",children:[(0,s.jsx)("circle",{cx:"12",cy:"5",r:"1"}),(0,s.jsx)("circle",{cx:"12",cy:"12",r:"1"}),(0,s.jsx)("circle",{cx:"12",cy:"19",r:"1"})]})}),U===e.id&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-dark-surface rounded-card shadow-lg py-2 border border-dark-border z-10",children:[x&&(e.userId===x.id||x.isAdmin)&&(0,s.jsxs)("button",{onClick:()=>{V(e),L(null)},className:"w-full text-left px-4 py-2 text-text-primary hover:bg-white/5 flex items-center gap-3",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,s.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),"Edit post"]}),(0,s.jsxs)("button",{onClick:()=>{alert("Link copied!"),L(null)},className:"w-full text-left px-4 py-2 text-text-primary hover:bg-white/5 flex items-center gap-3",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),(0,s.jsx)("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),"Copy link"]}),(0,s.jsxs)("button",{onClick:()=>{W(e.id),L(null)},className:"w-full text-left px-4 py-2 text-text-primary hover:bg-white/5 flex items-center gap-3",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),(0,s.jsx)("line",{x1:"4",y1:"22",x2:"4",y2:"15"})]}),"Report"]}),(null==x?void 0:x.isAdmin)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"border-t border-dark-border my-2"}),(0,s.jsxs)("button",{onClick:()=>{z(e.id),L(null)},className:"w-full text-left px-4 py-2 text-red-500 hover:bg-white/5 flex items-center gap-3",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,s.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),"Delete post"]})]})]})]})]})]}),j===e.id&&(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:()=>J(e.id),className:"px-5 py-2.5 bg-brand-yellow text-black rounded-button font-semibold hover:scale-105 btn-transition",children:"SAVE"}),(0,s.jsx)("button",{onClick:H,className:"px-5 py-2.5 bg-transparent text-text-primary border border-dark-border rounded-button font-semibold hover:bg-white/5 btn-transition",children:"CANCEL"})]})]},e.id)})}),f&&(0,s.jsx)(i(),{href:"/create",className:"fixed bottom-8 right-6 w-16 h-16 bg-brand-yellow rounded-fab flex items-center justify-center shadow-xl shadow-brand-yellow/40 text-black text-4xl font-light hover:scale-110 hover:shadow-2xl hover:shadow-brand-yellow/60 active:scale-95 btn-transition z-50",children:"+"})]})}},6536:(e,t,r)=>{"use strict";function s(e){try{let t=new URL(e);if("www.youtube.com"===t.hostname||"youtube.com"===t.hostname){if("/watch"===t.pathname)return t.searchParams.get("v");if(t.pathname.startsWith("/embed/"))return t.pathname.split("/")[2]}if("youtu.be"===t.hostname)return t.pathname.slice(1);return null}catch(e){return null}}function a(e){return"https://img.youtube.com/vi/".concat(e,"/maxresdefault.jpg")}function l(e){return"https://www.youtube.com/embed/".concat(e)}function i(e){return null!==s(e)}r.d(t,{CZ:()=>l,I9:()=>a,Zb:()=>s,t$:()=>i})}},e=>{var t=t=>e(e.s=t);e.O(0,[598,441,517,358],()=>t(4474)),_N_E=e.O()}]);